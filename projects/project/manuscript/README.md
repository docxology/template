# manuscript/ - Research Manuscript

Research manuscript sections in markdown format, converted to PDFs.

## Quick Start

### Edit Manuscript
```bash
vim manuscript/02_introduction.md
vim manuscript/S01_supplemental_methods.md
```

### Build PDFs
```bash
# Recommended: Full pipeline (tests + analysis + PDF + validation)
python3 scripts/run_all.py

# Or use interactive menu
./run.sh

# Render PDF only (after tests and analysis)
python3 scripts/03_render_pdf.py

# View output
open output/pdf/project_combined.pdf
# Or
open project/output/pdf/project_combined.pdf
```

## Manuscript Structure

This project includes the following sections:

### Main Sections
- `01_abstract.md` (~1.8 KB) - Research overview and key contributions
- `02_introduction.md` (~3.2 KB) - Project structure and motivation
- `03_methodology.md` (~5.4 KB) - Mathematical framework and algorithms
- `04_experimental_results.md` (~8.7 KB) - Performance evaluation and validation
- `05_discussion.md` (~4.3 KB) - Theoretical implications and comparisons
- `06_conclusion.md` (~2.1 KB) - Summary and future work
- `08_acknowledgments.md` (~0.8 KB) - Funding and acknowledgments
- `09_appendix.md` (~3.6 KB) - Technical details and proofs

### Supplemental Materials
- `S01_supplemental_methods.md` (~6.2 KB) - Extended methodological details
- `S02_supplemental_results.md` (~7.8 KB) - Additional experimental results
- `S03_supplemental_analysis.md` (~5.9 KB) - Extended theoretical analysis and complexity
- `S04_supplemental_applications.md` (~4.7 KB) - Additional application examples

### Supporting Files
- `references.bib` - Bibliography entries in BibTeX format
- `99_references.md` (~1.4 KB) - References section (auto-generated from .bib)
- `98_symbols_glossary.md` (~2.3 KB) - Notation and terminology (optional)

### Configuration
- `config.yaml` - Paper metadata (title, authors, DOI)
- `preamble.md` - LaTeX preamble customizations

## Rendering Process

The manuscript is rendered through these stages:

1. **Discovery**: All `.md` and `.tex` files are discovered and categorized
2. **Individual Rendering**: Each section rendered to PDF separately
3. **Combination**: All sections combined into single manuscript PDF
4. **Output**: Generated files placed in `../output/pdf/`

View detailed rendering logs to see which sections were included.

## File Structure

### Main Sections (01-09)
- `01_abstract.md` - Research overview
- `02_introduction.md` - Project structure
- `03_methodology.md` - Mathematical framework
- `04_experimental_results.md` - Performance evaluation
- `05_discussion.md` - Theoretical implications
- `06_conclusion.md` - Summary and future work
- `08_acknowledgments.md` - Funding and acknowledgments
- `09_appendix.md` - Technical details and proofs

### Supplemental Sections (S01-S0N)
- `S01_supplemental_methods.md` - Extended methodological details
- `S02_supplemental_results.md` - Additional experimental results
- `S03_supplemental_analysis.md` - Extended theoretical analysis and complexity
- `S04_supplemental_applications.md` - Additional application examples

### Reference Sections (98-99)
- `98_symbols_glossary.md` - Auto-generated API reference
- `99_references.md` - Bibliography (always last)

### Supporting Files
- `preamble.md` - LaTeX configuration (no PDF)
- `references.bib` - BibTeX bibliography
- `config.yaml` - Paper metadata configuration (version-controllable)
- `config.yaml.example` - Configuration template

## Numbering Convention

**Main sections:** 01-09 (core manuscript)
**Supplemental sections:** S01-S0N (additional material)
**Reference sections:** 98 (glossary), 99 (bibliography - always last)

**Adding new sections:**
- Main: Use next number (e.g., `07_new_section.md`)
- Supplemental: Use next S## (e.g., `S03_new_supplement.md`)
- Keep references as `99_references.md`
- Keep glossary as `98_symbols_glossary.md`

## Cross-Referencing

### Sections
```markdown
## Introduction {#sec:intro}
See \ref{sec:intro} for details.
See \ref{sec:supplemental_methods} for extended methods.
```

### Equations
```markdown
\begin{equation}
\label{eq:myeq}
f(x) = x^2
\end{equation}
Using \eqref{eq:myeq}...
```

### Figures
```markdown
\begin{figure}[h]
\includegraphics[width=0.8\textwidth]{../output/figures/example_figure.png}
\caption{Example figure generated by scripts/example_figure.py.}
\label{fig:example_figure}
\end{figure}
See \ref{fig:example_figure}...
```

## Configuration

### Method 1: Configuration File (Recommended)

Edit `config.yaml` in the `manuscript/` directory:

```yaml
paper:
  title: "My Research Paper"

authors:
  - name: "Dr. Jane Smith"
    orcid: "0000-0000-0000-1234"
    email: "jane@example.edu"
    affiliation: "University of Example"
    corresponding: true

publication:
  doi: "10.5281/zenodo.12345678"  # Optional
```

See `config.yaml.example` for all available options.

### Method 2: Environment Variables (Alternative)

```bash
export AUTHOR_NAME="Dr. Jane Smith"
export PROJECT_TITLE="My Research"
export AUTHOR_EMAIL="jane@example.edu"
python3 scripts/03_render_pdf.py
```

**Priority**: Environment variables override config file values.

## Validation

```bash
# Check markdown
python3 -m infrastructure.validation.cli markdown project/manuscript/

# Check PDF
python3 -m infrastructure.validation.cli pdf project/output/pdf/
```

## Quality Validation

- Run `python3 project/scripts/manuscript_preflight.py --strict` before rendering to ensure figures, glossary markers, and references are present.
- Generate consolidated metrics with `python3 project/scripts/quality_report.py` (readability, integrity, reproducibility snapshots).
- Figure registry and anchors are validated with `validate_figure_registry` and `validate_markdown` as part of the pipeline.

## Section Ordering

The build system automatically orders sections:
1. **Main sections** (01-09) - Core manuscript
2. **Supplemental sections** (S01-S0N) - Additional material
3. **Glossary** (98) - Auto-generated API reference
4. **References** (99) - Bibliography (always last)

This ensures proper document flow with supplemental material clearly separated from main content.

## Citation Management

### Adding Citations

1. Add the bibliography entry to `references.bib`:
```bibtex
@article{mykey2024,
  title={Paper Title},
  author={Author, Name},
  journal={Journal Name},
  year={2024}
}
```

2. Cite in markdown using `\cite{}`:
```markdown
According to recent research \cite{mykey2024}, this technique...
```

### Bibliography Processing

- Citations are processed using **BibTeX** with the `plainnat` style
- The bibliography file (`references.bib`) is copied into the build directory to satisfy BibTeX security constraints
- All `\cite{}` commands are resolved to numbered citations `[1], [2], ...` during PDF compilation
- The References section is auto-generated from all cited entries in `references.bib`

## Figure Management

### Adding Figures

1. Generate figures using scripts in `scripts/` (e.g., `example_figure.py`)
2. Figures are saved to `../output/figures/`
3. Reference in markdown using LaTeX includegraphics:
```markdown
\includegraphics[width=0.9\textwidth]{../output/figures/convergence_plot.png}
Figure \ref{fig:convergence_plot} shows...
```

4. Add labels to your figures:
```markdown
\label{fig:convergence_plot}
```

### Figure Path Resolution

- Figure paths use relative references (`../output/figures/filename.png`)
- The rendering system resolves paths relative to the `project/` directory
- All referenced figures must exist before PDF generation

## Troubleshooting

### Citations showing as [?]

- Verify bibliography entry exists in `references.bib`
- Check for typos in citation keys (case-sensitive)
- Run `python3 scripts/run_all.py` to regenerate from scratch
- Or use `./run.sh` and select option 4 (full pipeline)

### Figures not appearing

- Verify file exists in `project/output/figures/`
- Check path references use correct relative paths
- Ensure image format is supported (PNG, PDF, JPG)

## See Also

- [`AGENTS.md`](AGENTS.md) - Detailed documentation
- [`../../.cursorrules/manuscript_style.md`](../../.cursorrules/manuscript_style.md) - Complete manuscript formatting and style guide
- [`preamble.md`](preamble.md) - LaTeX configuration
- [`../../docs/MARKDOWN_TEMPLATE_GUIDE.md`](../../docs/MARKDOWN_TEMPLATE_GUIDE.md) - Full guide
