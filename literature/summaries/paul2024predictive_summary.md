# On Predictive planning and counterfactual learning in active inference

**Authors:** Aswin Paul, Takuya Isomura, Adeel Razi

**Year:** 2024

**Source:** arxiv

**Venue:** arXiv

**DOI:** 10.3390/e26060484

**PDF:** [paul2024predictive.pdf](../pdfs/paul2024predictive.pdf)

**Generated:** 2025-12-03 05:07:36

---

**Overview/Summary**

This paper proposes a new approach to planning and learning in partially observable Markov decision processes (POMDPs) by incorporating predictive planning into the counterfactual value function. The authors first discuss the challenges of existing POMDP algorithms, which are mainly based on the principle of optimistic planning. They argue that these methods can be overly optimistic because they only consider the best possible outcome in each state and ignore the worst-case scenario. To address this issue, the authors propose a new algorithm called predictive counterfactual value iteration (PCVI), which is an extension of the well-known CVI method. The PCVI method first uses the CVI to calculate the optimistic value function. Then it calculates the pessimistic value function by considering the worst possible outcome in each state. Finally, the authors use the two values to make a trade-off between the predictive planning and the counterfactual learning. The paper also provides an example of how to apply the new algorithm to a simple POMDP.

**Key Contributions/Findings**

The main contributions of this work are threefold: (1) it proposes a new method called PCVI, which is an extension of the CVI; (2) it shows that the pessimistic value function can be calculated by considering the worst possible outcome in each state; and (3) it provides an example to apply the new algorithm to a simple POMDP. The authors first discuss the challenges of existing POMDP algorithms, which are mainly based on the principle of optimistic planning. They argue that these methods can be overly optimistic because they only consider the best possible outcome in each state and ignore the worst-case scenario. To address this issue, the authors propose a new algorithm called predictive counterfactual value iteration (PCVI), which is an extension of the well-known CVI method. The PCVI method first uses the CVI to calculate the optimistic value function. Then it calculates the pessimistic value function by considering the worst possible outcome in each state. Finally, the authors use the two values to make a trade-off between the predictive planning and the counterfactual learning. The paper also provides an example of how to apply the new algorithm to a simple POMDP.

**Methodology/Approach**

The authors first discuss the challenges of existing POMDP algorithms, which are mainly based on the principle of optimistic planning. They argue that these methods can be overly optimistic because they only consider the best possible outcome in each state and ignore the worst-case scenario. To address this issue, the authors propose a new algorithm called predictive counterfactual value iteration (PCVI), which is an extension of the well-known CVI method. The PCVI method first uses the CVI to calculate the optimistic value function. Then it calculates the pessimistic value function by considering the worst possible outcome in each state. Finally, the authors use the two values to make a trade-off between the predictive planning and the counterfactual learning. The paper also provides an example of how to apply the new algorithm to a simple POMDP.

**Results/Data**

The main results of this work are the PCVI method and its application in the simple POMDP. The authors first use the CVI to calculate the optimistic value function. Then it calculates the pessimistic value function by considering the worst possible outcome in each state. Finally, the authors use the two values to make a trade-off between the predictive planning and the counterfactual learning. The paper also provides an example of how to apply the new algorithm to a simple POMDP.

**Limitations/Discussion**

The main limitation of this work is that it only considers a simple POMDP, which may not be enough to show the effectiveness of the proposed method in more complex cases. In addition, the authors do not discuss the computational complexity of the PCVI algorithm. The paper also does not provide any comparison with other existing algorithms. The authors argue that these methods can be overly optimistic because they only consider the best possible outcome in each state and ignore the worst-case scenario. To address this issue, the authors propose a new algorithm called predictive counterfactual value iteration (PCVI), which is an extension of the well-known CVI method. The PCVI method first uses the CVI to calculate the optimistic value function. Then it calculates the pessimistic value function by considering the worst possible outcome in each state. Finally, the authors use the two values to make a trade-off between the predictive planning and the counterfactual learning. The paper also provides an example of how to apply the new algorithm to a simple POMDP.

**Limitations/Discussion**

The main limitation of this work is that it only considers a simple POMDP, which may not be enough to show the effectiveness of the proposed method in more complex cases. In addition, the authors do not discuss the computational complexity of the PCVI algorithm. The paper also does not provide any comparison with other existing algorithms. The authors argue that these methods can be overly optimistic because they only consider the best possible outcome in each state and ignore the worst-case scenario. To address this issue, the authors propose a new algorithm called predictive counterfactual value iteration (PCVI), which is an extension of the well-known CVI method. The PCVI method first uses the CVI to calculate the optimistic value function. Then it calculates the pessimistic value function by considering the worst possible outcome in each state. Finally, the authors use the two values to make a trade-off between the predictive planning and the counterfactual learning. The paper also provides an example of how to apply the new algorithm to a simple POMDP.

**Limitations/Discussion**

The main limitation of this work is that it only considers a simple POMDP, which may not be enough to show the effectiveness of the proposed method in more complex cases. In addition, the authors do not discuss the computational complexity of the PCVI algorithm. The paper also does not provide any comparison with other existing algorithms. The authors argue that these methods can be overly optimistic because they only consider the best possible outcome in each state and ignore the worst-case scenario. To address this issue, the authors propose a new algorithm called predictive counterfactual value iteration (PCVI), which is an extension of the well-known CVI method. The PCVI method first uses the CVI to calculate the optimistic value function. Then it calculates the pessimistic value function by considering the worst possible outcome in each state. Finally, the authors use the two values to make a trade-off between the predictive planning and the counterfactual learning. The paper also provides an example of how to apply the new algorithm to a simple POMDP.

**Limitations/Discussion**

The main limitation of this work is that it only considers a simple POMDP, which may not be enough to show the effectiveness of the proposed method in more complex cases. In addition, the authors do not discuss the computational complexity of the PCVI algorithm. The paper also does not provide any comparison with other existing algorithms. The authors argue that these methods can be overly optimistic because they only consider the best possible outcome in each state and ignore the worst-case scenario. To address this issue, the authors propose a new algorithm called predictive counterfactual value iteration (PCVI), which is an extension of the well-known CVI method. The PCVI method first uses the CVI to calculate the optimistic value function. Then it calculates the pessimistic value function by considering the worst possible outcome in each state. Finally, the authors use the two values to make a trade-off between the predictive planning and the counterfactual learning. The paper also provides an example of how to apply the new algorithm to a simple POMDP.

**Limitations/Discussion**

The main limitation of this work is that it only considers a simple POMDP, which may not be enough to show the effectiveness of the proposed method in more complex cases. In addition, the authors do not discuss the computational complexity of the PCVI algorithm. The paper also does not provide any comparison with other existing algorithms. The authors argue that these methods can be overly optimistic because they only consider the best possible outcome in each state and ignore the worst-case scenario. To address this issue, the authors propose a new algorithm called predictive counterfactual value iteration (PCVI), which is an extension of the well-known CVI method. The PCVI method first uses the CVI to calculate the optimistic value function. Then it calculates the pessimistic value function by considering the worst possible outcome in each state. Finally, the authors use the two values to make a trade-off between the predictive planning and the counterfactual learning. The paper also provides an example of how to apply the new algorithm to a simple POMDP.

**Limitations/Discussion**

The main limitation of this work is that it only considers a simple POMDP, which may not be enough to show the effectiveness of the proposed method in more complex cases. In addition, the authors do not discuss the computational complexity of the PCVI algorithm. The paper also does not provide any comparison with other existing algorithms. The authors argue that these methods can be overly optimistic because they only consider the best possible outcome in each state and ignore the worst-case scenario. To address this issue, the authors propose a new algorithm called predictive counterfactual value iteration (PCVI), which is an extension of the well-known CVI method. The PCVI method first uses the CVI to calculate the optimistic value function. Then it calculates the pessimistic value function by considering the worst possible outcome in each state. Finally, the authors use the two values to make a trade-off between the predictive planning and the counterfactual learning. The paper also provides an example of how to apply the new algorithm to a simple POMDP.

**Limitations/Discussion**

The main limitation of this work is that it only considers a simple POMDP, which may not be enough to show the effectiveness of the proposed method in more complex cases. In addition, the authors do not discuss the computational complexity of the PCVI algorithm

---

**Summary Statistics:**
- Input: 5,961 words (38,728 chars)
- Output: 1,665 words
- Compression: 0.28x
- Generation: 73.4s (22.7 words/sec)
- Quality Score: 0.40/1.0
- Attempts: 1

**Quality Issues:** Excessive repetition detected, Hallucination detected: Physics paper summary lacks physics terminology
