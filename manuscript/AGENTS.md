# manuscript/ - Research Manuscript

## Purpose

The `manuscript/` directory contains research manuscript sections in markdown format. These files are processed by `render_pdf.sh` to generate individual section PDFs and a combined manuscript document.

## File Structure

### Manuscript Sections (Generate PDFs)

| File | Purpose | Generates PDF |
|------|---------|---------------|
| `01_abstract.md` | Research overview and key contributions | ✅ |
| `02_introduction.md` | Project structure and motivation | ✅ |
| `03_methodology.md` | Mathematical framework and algorithms | ✅ |
| `04_experimental_results.md` | Performance evaluation and validation | ✅ |
| `05_discussion.md` | Theoretical implications and comparisons | ✅ |
| `06_conclusion.md` | Summary and future directions | ✅ |
| `07_references.md` | Bibliography and cited works | ✅ |
| `10_symbols_glossary.md` | Auto-generated API reference from `src/` | ✅ |

### Supporting Files (No PDF Generation)

| File | Purpose |
|------|---------|
| `preamble.md` | LaTeX preamble and document styling |
| `references.bib` | BibTeX bibliography database |

## Numbering Convention

Files are numbered to control ordering:
- `01-07`: Standard manuscript sections (sequential)
- `10`: Glossary (generated from `src/` API)
- `preamble.md`: Special file for LaTeX configuration

This ordering ensures proper document flow in the combined PDF.

## preamble.md - LaTeX Styling

The `preamble.md` file contains LaTeX configuration wrapped in markdown code blocks:

```markdown
# LaTeX Preamble

```latex
\usepackage{amsmath}
\usepackage{graphicx}
% ... additional LaTeX commands ...
```
```

**Key features:**
- Custom LaTeX packages
- Document styling
- Mathematical notation setup
- Figure and table formatting
- Cross-reference configuration

**Note:** Does NOT generate a separate PDF - content is extracted and injected into document preambles.

## references.bib - Bibliography

BibTeX format bibliography file:

```bibtex
@article{author2023,
  title={Title},
  author={Author, Name},
  journal={Journal},
  year={2023},
  volume={1},
  pages={1-10}
}
```

Citations in markdown:
```markdown
According to \cite{author2023}, the method...
```

## Cross-Referencing

### Section References
```markdown
## Introduction {#sec:introduction}

As discussed in \ref{sec:introduction}...
```

### Equation References
```markdown
\begin{equation}
\label{eq:myequation}
f(x) = x^2
\end{equation}

Using \eqref{eq:myequation}, we derive...
```

### Figure References
```markdown
\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{../output/figures/example_figure.png}
\caption{Example figure demonstrating the concept.}
\label{fig:example}
\end{figure}

As shown in \ref{fig:example}...
```

### Table References
```markdown
\begin{table}[h]
\centering
\begin{tabular}{ll}
Item & Value \\
\hline
A & 1 \\
B & 2 \\
\end{tabular}
\caption{Example table.}
\label{tab:example}
\end{table}

Table \ref{tab:example} shows...
```

## LaTeX Integration

### Mathematical Notation

**Inline math:**
```markdown
The variable $x$ represents...
```

**Display equations:**
```markdown
\begin{equation}
\label{eq:name}
f(x) = \int_0^x t^2 dt
\end{equation}
```

**Do NOT use:**
- `$$...$$` for display math (use equation environment)
- `\[...\]` for display math (use equation environment)

### Figure Integration

Figures must reference files in `output/figures/`:

```markdown
\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{../output/figures/convergence_plot.png}
\caption{Convergence behavior over iterations.}
\label{fig:convergence}
\end{figure}
```

**Requirements:**
- Path: `../output/figures/` (relative to manuscript/)
- Generated by scripts in `scripts/`
- PNG format recommended
- Descriptive labels (e.g., `fig:convergence`)

## 10_symbols_glossary.md - Auto-Generation

This file is **automatically generated** from `src/` module APIs:

```markdown
# API Symbols Glossary

This glossary is auto-generated from the public API in `src/`.

<!-- BEGIN: AUTO-API-GLOSSARY -->
| Module | Name | Kind | Summary |
|---|---|---|---|
| `example` | `add_numbers` | function | Add two numbers together. |
| `example` | `calculate_average` | function | Calculate the average of a list... |
<!-- END: AUTO-API-GLOSSARY -->
```

**Generation process:**
1. `repo_utilities/generate_glossary.py` scans `src/`
2. Extracts public functions and classes
3. Builds markdown table
4. Injects between markers in `markdown/10_symbols_glossary.md`
5. Copied to `manuscript/10_symbols_glossary.md` during build

**Do NOT edit** the auto-generated content between markers.

## Building PDFs

### Individual Section PDFs

```bash
# Builds all individual section PDFs
./repo_utilities/render_pdf.sh
```

Output: `output/pdf/01_abstract.pdf`, `02_introduction.pdf`, etc.

### Combined Manuscript PDF

```bash
# Builds combined manuscript
./repo_utilities/render_pdf.sh
```

Output: `output/pdf/project_combined.pdf`

**Combined PDF includes:**
- Custom title page
- Abstract (before TOC)
- Table of contents
- All numbered sections
- Bibliography
- API glossary

## Editing Workflow

### 1. Edit Markdown Files
Edit any `*.md` file in `manuscript/` directory:
```bash
vim manuscript/02_introduction.md
```

### 2. Generate Figures (if needed)
If adding new figures, create script in `scripts/`:
```python
# scripts/my_figure.py
from example import calculate_average
# ... generate figure ...
plt.savefig("output/figures/my_figure.png")
```

### 3. Reference Figure in Markdown
```markdown
\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{../output/figures/my_figure.png}
\caption{My new figure.}
\label{fig:myfigure}
\end{figure}
```

### 4. Validate and Build
```bash
# Clean previous outputs
./repo_utilities/clean_output.sh

# Build everything
./repo_utilities/render_pdf.sh
```

### 5. Review Output
```bash
# Open combined PDF
open output/pdf/project_combined.pdf

# Or HTML version (better for IDEs)
open output/project_combined.html
```

## Configuration

Metadata configured via environment variables before building:

```bash
export AUTHOR_NAME="Dr. Jane Smith"
export AUTHOR_ORCID="0000-0000-0000-1234"
export AUTHOR_EMAIL="jane.smith@university.edu"
export PROJECT_TITLE="Advanced Research Framework"
export DOI="10.5281/zenodo.12345678"  # Optional

./repo_utilities/render_pdf.sh
```

## Validation

### Markdown Validation
```bash
# Check for issues
python3 repo_utilities/validate_markdown.py

# Strict mode (fail on any issues)
python3 repo_utilities/validate_markdown.py --strict
```

**Validates:**
- Image references exist
- Cross-references are valid
- Equation labels are unique
- No bare URLs
- LaTeX equation syntax

### PDF Validation
```bash
# Check rendered PDF
python3 repo_utilities/validate_pdf_output.py

# Specific section
python3 repo_utilities/validate_pdf_output.py output/pdf/01_abstract.pdf
```

**Detects:**
- Unresolved references (??)
- Missing citations ([?])
- LaTeX warnings
- Rendering issues

## Best Practices

### Markdown Writing
- Use descriptive cross-reference labels
- Always label equations, figures, and tables
- Keep section structure hierarchical
- Use consistent heading levels

### Figure Integration
- Generate figures from scripts (reproducible)
- Save to `output/figures/`
- Use descriptive filenames
- Include captions and labels

### Cross-References
- Use `\ref{}` for sections, figures, tables
- Use `\eqref{}` for equations
- Use `\cite{}` for bibliography
- Ensure all references have labels

### LaTeX Math
- Use equation environment for display math
- Label all important equations
- Use `\eqref{}` to reference equations
- Avoid `$$` or `\[...\]`

## Output Formats

### Standard PDF (`project_combined.pdf`)
- Professional printing quality
- Full LaTeX rendering
- Complete cross-references
- Publication-ready

### IDE-Friendly PDF (`project_combined_ide_friendly.pdf`)
- Optimized for text editor viewing
- Better font rendering
- Simplified layout

### HTML Version (`project_combined.html`)
- Web browser compatible
- IDE integration
- Interactive features
- Faster loading

## Troubleshooting

### Missing Figures
```bash
# Ensure scripts generated figures
ls output/figures/

# Check figure path in markdown
grep "includegraphics" manuscript/*.md
```

### Unresolved References
```bash
# Validate all references
python3 repo_utilities/validate_markdown.py

# Check for ?? in PDF
python3 repo_utilities/validate_pdf_output.py
```

### LaTeX Errors
```bash
# Check compilation log
cat output/pdf/project_combined_compile.log
```

## See Also

- [`preamble.md`](preamble.md) - LaTeX configuration
- [`references.bib`](references.bib) - Bibliography
- [`../docs/MARKDOWN_TEMPLATE_GUIDE.md`](../docs/MARKDOWN_TEMPLATE_GUIDE.md) - Markdown guide
- [`../repo_utilities/README.md`](../repo_utilities/README.md) - Build tools
- [`../AGENTS.md`](../AGENTS.md) - Complete system documentation

